name: keepalive

on:
  schedule:
    - cron: "*/10 * * * *"   # 10분마다 실행
  workflow_dispatch:
  push:
    paths:
      - ".github/workflows/keepalive.yml"

jobs:
  ping:
    runs-on: ubuntu-latest
    steps:
      # 1) 기존 만세력 API 깨우기
      - name: Ping Manseryeok API
        run: curl -fsS -m 10 https://my-manseryeok.onrender.com/ping || true

      # 2) Proxy 서버 깨우기
      - name: Ping Proxy
        run: curl -fsS -m 10 https://saju-proxy.onrender.com/ping || true

      # 3) 결제 서버 (Vercel)
      - name: Ping Payment Server
        run: curl -fsS -m 10 https://easysaju-test.vercel.app/api/ping || true

      # 4) Products API (GAS WebApp)
      - name: Ping Products GAS
        run: curl -fsS -m 10 "https://script.google.com/macros/s/AKfycbxqdItEzCRdoaBbHWUM3EOqaCIBGRsT3uF6huiC2sfvt_RyyULixbo7ipXAp8kvfOuA/exec?ping=1" || true

      # 5) 결제 토큰 저장용 GAS WebApp
      - name: Ping GAS Token Store
        run: curl -fsS -m 10 "https://script.google.com/macros/s/AKfycbx1LiZJ2A1beNiUOoScSswp97Bpf_g1eNqn1UanX3hFlA-Nqnoj3Qg0RPF0fLVE2CRuQQ/exec?ping=1" || true

      # 6) 주문 기록용 Logger GAS WebApp
      - name: Ping Order Logger GAS
        run: curl -fsS -m 10 "https://script.google.com/macros/s/AKfycbzhi4556hgBKctN3KVBlPdkl1vFD3oG7Wv7Hdm6pk16VGG8OF6q6EaPT8t_5WTX87Jb/exec?ping=1" || true
